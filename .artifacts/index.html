<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Local CI Summary</title>
<style>
 body{font-family:Segoe UI, sans-serif;margin:16px}
 .row{display:flex;gap:10px;align-items:center}
 .tz-table{margin-top:14px}
 .badge{padding:4px 8px;border:1px solid #ddd;border-radius:6px;background:#f6f6f6}
</style>
</head>
<body>
  <p>Generated: 11/11/2025 13:43:24</p>

  <div class="row">
    <label><b>Timezone:</b></label>
    <select id="tzSelect"><option value="">Local time (default)</option>
<option value="Eastern">Eastern</option>
<option value="Central">Central</option>
<option value="Mountain">Mountain</option>
<option value="Pacific">Pacific</option>
<option value="UTC">UTC</option></select>
<!-- LIVE TZ CLOCK BEGIN -->
<div id="tzNowWrap" style="margin:6px 0 0 0;color:#666;font-size:12px">
  <span id="tzNowLabel">Now (TZ):</span>
  <span id="tzNow">--:--:--</span>
</div>
<script>
(function(){
  const iana = { local:(Intl.DateTimeFormat().resolvedOptions().timeZone||'UTC'),
    eastern:'America/New_York', central:'America/Chicago',
    mountain:'America/Denver', pacific:'America/Los_Angeles', utc:'UTC' };
  function sel(){ return document.getElementById('tzSelect')||document.querySelector('select[name="tz"]')||document.querySelector('select'); }
  const s = sel(), span = document.getElementById('tzNow');
  function fmt(z){ const d=new Date(); return d.toLocaleString(undefined,{timeZone:z,year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false}); }
  function tick(){ const v=(s&&s.value)||'local'; span && (span.textContent = fmt(iana[v]||iana.local)+'  ('+v.toUpperCase()+')'); }
  if (s){ s.addEventListener('change', tick); setInterval(tick,1000); tick(); }
})();
</script>
<!-- LIVE TZ CLOCK END -->
    <button id="tzBtn" class="badge">TZ: Local time (default)</button>
  </div>

  <h2>Local CI Run Trend</h2>
  <img id="ciChart" src="ci/runs/runs_trend_local.png" width="800"/>

  <div id="tablesHost">
    <div class='tz-table' data-tz='local' style='display:none'><h3>Last 5 Runs <span style='font-size:12px;color:#555'>(TZ: Local, valid rows: 16)</span></h3>
<table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;font-family:Segoe UI,sans-serif'>
<tr><th>Timestamp</th><th>Files</th><th>Total MB</th></tr>
<tr><td>2025-11-11T11:27:30</td><td style='text-align:right'>51</td><td style='text-align:right'>0.13</td></tr>
<tr><td>2025-11-11T12:42:37</td><td style='text-align:right'>11759</td><td style='text-align:right'>1237.011</td></tr>
<tr><td>2025-11-11T12:48:01</td><td style='text-align:right'>11760</td><td style='text-align:right'>1237.012</td></tr>
<tr><td>2025-11-11T12:50:32</td><td style='text-align:right'>11761</td><td style='text-align:right'>1237.012</td></tr>
<tr><td>2025-11-11T12:54:52</td><td style='text-align:right'>11762</td><td style='text-align:right'>1237.012</td></tr>
</table>
</div>
<div class='tz-table' data-tz='central' style='display:none'><h3>Last 5 Runs <span style='font-size:12px;color:#555'>(TZ: Local, valid rows: 0)</span></h3>
<table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;font-family:Segoe UI,sans-serif'>
<tr><th>Timestamp</th><th>Files</th><th>Total MB</th></tr>
</table>
</div>
<div class='tz-table' data-tz='eastern' style='display:none'><h3>Last 5 Runs <span style='font-size:12px;color:#555'>(TZ: Local, valid rows: 0)</span></h3>
<table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;font-family:Segoe UI,sans-serif'>
<tr><th>Timestamp</th><th>Files</th><th>Total MB</th></tr>
</table>
</div>
<div class='tz-table' data-tz='mountain' style='display:none'><h3>Last 5 Runs <span style='font-size:12px;color:#555'>(TZ: Local, valid rows: 0)</span></h3>
<table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;font-family:Segoe UI,sans-serif'>
<tr><th>Timestamp</th><th>Files</th><th>Total MB</th></tr>
</table>
</div>
<div class='tz-table' data-tz='pacific' style='display:none'><h3>Last 5 Runs <span style='font-size:12px;color:#555'>(TZ: Local, valid rows: 0)</span></h3>
<table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;font-family:Segoe UI,sans-serif'>
<tr><th>Timestamp</th><th>Files</th><th>Total MB</th></tr>
</table>
</div>
<div class='tz-table' data-tz='utc' style='display:none'><h3>Last 5 Runs <span style='font-size:12px;color:#555'>(TZ: Local, valid rows: 0)</span></h3>
<table border='1' cellpadding='6' cellspacing='0' style='border-collapse:collapse;font-family:Segoe UI,sans-serif'>
<tr><th>Timestamp</th><th>Files</th><th>Total MB</th></tr>
</table>
</div>
  </div>

  <div style="margin-top:10px;color:#888;font-size:12px"><div style='margin-top:10px;color:#888;font-size:12px'>Use rebuild_ci.cmd to refresh without adding a new run.</div></div>

<script>
(function(){
  function getParam(name){
    const u = new URL(window.location.href);
    return u.searchParams.get(name) || "";
  }
  function showTable(tz){
    document.querySelectorAll('.tz-table').forEach(div=>{
      div.style.display = (div.getAttribute('data-tz') === tz) ? 'block' : 'none';
    });
  }
  function applyTZ(tz){
    const chart = document.getElementById('ciChart');
    // compute image path from tz
    const stem = 'ci/runs/runs_trend_';
    chart.src = stem + (tz ? tz : 'local') + '.png';
    showTable(tz || '');
    const badge = document.getElementById('tzBtn');
    badge.textContent = 'TZ: ' + (tz || 'Local time (default)');
    const u = new URL(window.location.href);
    if (tz) { u.searchParams.set('tz', tz); } else { u.searchParams.delete('tz'); }
    history.replaceState(null, '', u.toString());
  }

  // init selection
  const initial = getParam('tz');               // "", "Eastern", ...
  const sel = document.getElementById('tzSelect');
  sel.value = initial;
  applyTZ(initial);

  sel.addEventListener('change', ()=>applyTZ(sel.value));
  document.getElementById('tzBtn').addEventListener('click', ()=>applyTZ(sel.value));
})();
</script>
<!-- TZ SWITCH PATCH BEGIN -->
<script>
(function(){
  function findTzSelect(){
    return document.getElementById('tzSelect')
        || document.querySelector('select[name="tz"]')
        || document.querySelector('select');
  }
  function findChartImg(){
    // pick the first <img> whose src looks like our trend image
    const imgs = Array.from(document.querySelectorAll('img'));
    return imgs.find(i => /ci\/runs\/runs_trend_/i.test(i.getAttribute('src')||i.src));
  }
  const tzMap = { local:'local', eastern:'Eastern', central:'Central', mountain:'Mountain', pacific:'Pacific', utc:'UTC' };

  const sel  = findTzSelect();
  const img  = findChartImg();
  const label= document.getElementById('tzLabel');

  function show(tz){
    if (!img) return;
    const suf = tzMap[tz] || 'local';
    // update chart src
    const base = 'ci/runs/runs_trend_' + suf + '.png';
    img.setAttribute('src', base);

    // toggle tables
    document.querySelectorAll('.tz-table').forEach(d => {
      d.style.display = (d.dataset.tz === tz) ? '' : 'none';
    });

    // update label + url param
    if (label) label.textContent = 'TZ: ' + tz.toUpperCase();
    try {
      const url = new URL(window.location.href);
      url.searchParams.set('tz', tz);
      history.replaceState(null, '', url);
    } catch (_) {}
  }

  if (sel) {
    // init from ?tz= if present
    try {
      const urlTz = new URL(window.location.href).searchParams.get('tz');
      if (urlTz && tzMap[urlTz]) sel.value = urlTz;
    } catch (_) {}

    sel.addEventListener('change', e => show(e.target.value));
    show(sel.value || 'local');
  }
})();
</script>
<!-- TZ SWITCH PATCH END -->
</body>
</html>




